<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>STARSEED - Full Screen Edition</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background-color: #0d0d0d;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            user-select: none;
            -webkit-user-select: none;
            touch-action: none;
        }
        canvas {
            display: block;
            width: 100vw;
            height: 100vh;
            /* Ensures the background image fills the screen without distorting */
            object-fit: cover; 
        }
    </style>
</head>
<body>

<script>
// --- ADAPTIVE CONFIGURATION ---
const cvs = document.createElement("canvas");
const ctx = cvs.getContext("2d");

// We now grab the exact width and height of your phone screen
let gameWidth = window.innerWidth;
let gameHeight = window.innerHeight;
const dpr = window.devicePixelRatio || 1;

cvs.width = gameWidth * dpr;
cvs.height = gameHeight * dpr;
ctx.scale(dpr, dpr);

ctx.imageSmoothingEnabled = false;
document.body.appendChild(cvs);

// --- ASSETS ---
const birdImg = new Image(); birdImg.src = "bird.png"; 
const pipeImg = new Image(); pipeImg.src = "pillar.png"; 
const bgImg = new Image(); bgImg.src = "bg.png"; 
const music = new Audio(); music.src = "music.mp3"; music.loop = true;

// --- VARIABLES ---
let gamePlaying = false;
let frames = 0;
let score = 0;

// --- DYNAMIC STARFIELD ---
const starfield = {
    particles: [],
    init: function() {
        for(let i = 0; i < 150; i++) { 
            this.particles.push({
                x: Math.random() * gameWidth,
                y: Math.random() * gameHeight,
                size: Math.random() * 0.8 + 0.4, 
                speed: Math.random() * 1.5 + 0.1,
                opacity: Math.random() 
            });
        }
    },
    draw: function() {
        for(let i = 0; i < this.particles.length; i++) {
            let p = this.particles[i];
            p.opacity += (Math.random() - 0.5) * 0.1;
            if(p.opacity < 0.2) p.opacity = 0.2;
            if(p.opacity > 1) p.opacity = 1;
            ctx.fillStyle = (i % 5 === 0) ? `rgba(40, 255, 40, ${p.opacity})` : `rgba(255, 255, 255, ${p.opacity})`;
            ctx.fillRect(p.x, p.y, p.size, p.size);
        }
    },
    update: function() {
        let globalSpeed = gamePlaying ? 3.0 : 0.3; 
        for(let p of this.particles) {
            p.x -= (p.speed * globalSpeed);
            if(p.x < 0) { p.x = gameWidth; p.y = Math.random() * gameHeight; }
        }
    }
};
starfield.init();

// --- BIRD OBJECT (POSITIONED RELATIVELY) ---
const bird = {
    x: 50,
    y: gameHeight / 2, // Starts in the center of whatever screen size
    w: 45, h: 55, speed: 0, gravity: 0.3, jump: 5.5,    
    draw: function() {
        if (birdImg.complete) { ctx.drawImage(birdImg, this.x, this.y, this.w, this.h); }
        else { ctx.fillStyle = "#28ff28"; ctx.fillRect(this.x, this.y, this.w, this.h); }
    },
    update: function() {
        if (!gamePlaying) { this.y = (gameHeight/2) + Math.cos(frames/15) * 15; return; }
        this.speed += this.gravity;
        this.y += this.speed;
        if (this.y + this.h >= gameHeight || this.y <= 0) { gameOver(); }
    },
    flap: function() { this.speed = -this.jump; }
};

// --- PIPES OBJECT ---
const pipes = {
    position: [], w: 55, h: 400, gap: 150, dx: 3.5, 
    draw: function() {
        for(let p of this.position){
            let topY = p.y;
            let bottomY = p.y + this.h + p.currentGap;
            ctx.save();
            ctx.shadowColor = "#FFFFFF"; ctx.shadowBlur = 20;
            if (pipeImg.complete) {
                ctx.save();
                ctx.translate(p.x + this.w / 2, topY + this.h / 2);
                ctx.scale(1, -1);
                ctx.drawImage(pipeImg, -this.w / 2, -this.h / 2, this.w, this.h);
                ctx.restore();
                ctx.drawImage(pipeImg, p.x, bottomY, this.w, this.h);
            }
            ctx.restore();
        }
    },
    update: function() {
        if(!gamePlaying) return;
        if(frames % 90 == 0){
            this.position.push({ x: gameWidth, y: Math.floor(Math.random() * (-100 - -300 + 1) + -300), currentGap: this.gap, scored: false });
        }
        for(let i = 0; i < this.position.length; i++){
            let p = this.position[i];
            p.x -= this.dx;
            if( bird.x + bird.w - 10 > p.x && bird.x + 10 < p.x + this.w && 
               (bird.y + 10 < p.y + this.h || bird.y + bird.h - 10 > p.y + this.h + p.currentGap)){
                gameOver(); return; 
            }
            if(p.x + this.w <= 0){ this.position.shift(); i--; } 
            else if (p.x + this.w < bird.x && !p.scored) {
                p.scored = true; score++;
                if (score % 10 === 0) { this.dx += 0.8; if (this.gap > 115) this.gap -= 5; }
            }
        }
    }
};

// --- ENGINE ---
function draw(){
    // Background fills the entire screen
    if (bgImg.complete) { ctx.drawImage(bgImg, 0, 0, gameWidth, gameHeight); }
    else { ctx.fillStyle = "#000"; ctx.fillRect(0, 0, gameWidth, gameHeight); }
    
    starfield.draw(); 
    pipes.draw(); 
    bird.draw();

    // UI adjusted for full screen
    ctx.fillStyle = "#28ff28"; 
    ctx.font = "bold 40px Courier New";
    ctx.fillText(score, gameWidth/2 - 15, 80);

    if(!gamePlaying){
        ctx.fillStyle = "rgba(40, 255, 40, 0.9)"; 
        ctx.font = "bold 24px Courier New";
        ctx.textAlign = "center";
        ctx.fillText("INITIATE SEQUENCE", gameWidth/2, gameHeight/2 + 80);
        ctx.textAlign = "start";
    }
}

function loop(){ starfield.update(); bird.update(); pipes.update(); draw(); frames++; requestAnimationFrame(loop); }

function gameOver(){
    gamePlaying = false; bird.y = gameHeight/2; bird.speed = 0;
    pipes.position = []; pipes.dx = 3.5; pipes.gap = 150; score = 0; frames = 0;
    music.pause(); music.currentTime = 0;
}

function handleAction(e) {
    if (e) e.preventDefault();
    if(!gamePlaying){
        gamePlaying = true;
        music.play().catch(() => {});
    }
    bird.flap();
}

window.addEventListener("mousedown", handleAction);
window.addEventListener("touchstart", handleAction, { passive: false }); 
window.addEventListener("keydown", (e) => { if(e.code === "Space") handleAction(); });

// Handle screen rotation or resizing
window.addEventListener("resize", () => {
    gameWidth = window.innerWidth;
    gameHeight = window.innerHeight;
    cvs.width = gameWidth * dpr;
    cvs.height = gameHeight * dpr;
    ctx.scale(dpr, dpr);
    ctx.imageSmoothingEnabled = false;
    bird.y = gameHeight / 2;
});

loop();
</script>
</body>
</html>
